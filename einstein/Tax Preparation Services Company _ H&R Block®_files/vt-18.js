!function(r){var n,e,t,o,i,a,c;i={parseUri:function(r){for(var n={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},e=n.parser[n.strictMode?"strict":"loose"].exec(r),t={},o=14;o--;)t[n.key[o]]=e[o]||"";return t[n.q.name]={},t[n.key[12]].replace(n.q.parser,function(r,e,o){e&&(t[n.q.name][e]=o)}),t},runop:function(r){return 0==r.o.indexOf("!")?!t[r.o.substring(1)].f(r):t[r.o].f(r)},andorLOP:function(r,n){for(var t,o=0;o<r.length;o++){var i=r[o],a="o"in i?this.runop(i):e.rtl(i);t=void 0===t?a:"AND"==n?t&&a:t||a}return void 0!==t&&t},tcexec:function(r,e){var t=r.match(/{{\s*[\w\.]+\s*}}/g);if(t)for(var o=t.length;o--;){var i=t[o].match(/[\w\.]+/)[0],a="";"object"==typeof e[i]?(a=n[e[i].ds].f(e,i),"factory"in e[i]&&(a=window[e[i].factory](a))):a=e[i],a=void 0==a?"":a,r=r.split(t[o]).join(a)}return r},tc:function(r,n){if(this.isArray(r)){for(var e=[],t=0;t<r.length;t++)e.push(this.tcexec(r[t],n));return e}return this.tcexec(r,n)},isArray:function(r){return"[object Array]"===Object.prototype.toString.call(r)}},n={URI:{f:function(r,n,e){var t=n;if("p"in r){if(1!=e&&(t=i.parseUri(n)),"queryKey"in t)for(var o in t.queryKey)o.toLowerCase()in t.queryKey||"ck"in r&&1==r.ck||(t.queryKey[o.toLowerCase()]=t.queryKey[o]);for(var a=0;a<r.p.length;a++)t=a==r.p.length-1?"ck"in r&&1==r.ck?t[r.p[a]]:t[r.p[a].toLowerCase()]:t[r.p[a]]}if("cv"in r&&1==r.cv||(t="string"==typeof t?t.toLowerCase():t),"e"in r&&!isNaN(Number(r.e)))for(var c=0;c<r.e;c++)t=encodeURIComponent(t);return t}},RU:{f:function(r,e){var t=r[e];return n.URI.f(t,document.referrer)}},LP:{f:function(r,e){var t=r[e];return n.URI.f(t,document.URL)}},C:{f:function(r,e){var t=document.cookie,o=r[e],i={queryKey:{}};t=t.split("; ");for(var a=0;a<t.length;a++){var c=t[a].split("=");2==c.length&&(i.queryKey[c[0]]=c[1])}return n.URI.f(o,i,!0)}},JS:{f:function(r,n){var e=r[n];if("p"in e){var t=e.p[0];if("r"==t){var o=Math.random();return~~(1e7*(.1>o?o+.1:o))}if("ep"==t)return(new Date).getTime()}return""}},S:{f:function(r,n){var e=r[n],t="";if("v"in e&&(t=i.tc(e.v,r)),"e"in e&&!isNaN(Number(e.e)))for(var o=0;o<e.e;o++)t=encodeURIComponent(t);return t}},D:{f:function(r,n){var e=r[n],t=window;if("p"in e&&e.p.length>0)for(var o=e.p[0].split("."),i=0;i<o.length;i++){var a=o[i];if(!(a in t)){t=window;break}t=t[a]}return t===window?void 0:t}}},t={"==":{f:function(r){return r.cval==r.k}},in:{f:function(r){if(void 0==r.cval)return!1;var n=r.k;i.isArray(n)||(n=[n]);for(var e=!1,t=0;t<n.length;t++)if(-1!=r.cval.indexOf(n[t])){e=!0;break}return e}},inN:{f:function(r){if(void 0==r.cval)return!1;for(var n=r.k,e=!1,t=0;t<n.length;t++)if(-1!=r.cval.indexOf(n[t])){e=!0;break}return e}},Ain:{f:function(r){if(void 0==r.cval)return!1;for(var n=r.k,e=!0,t=0;t<n.length;t++)if(-1==r.cval.indexOf(n[t])){e=!1;break}return e}},ex:{f:function(r){return void 0!==r.cval}}},o={E:{f:function(r){return r.length>0&&i.runop(r[0])}},AND:{f:function(r){return i.andorLOP(r,"AND")}},OR:{f:function(r){return i.andorLOP(r,"OR")}}},a={url:function(r,n){var e=i.tc(n.tasks.url[r],n.dp);c.resq.push({url:e});var t=new Image;return t.src=e,t.onload=t.onerror=function(){c.asyncprogress()},!0},logics:function(r,n){return e.execLogicTask(n.tasks.logics[r],n)},c:function(r,n){var e=n.tasks.c[r].split(":",4);if(e.length>=3){var t=i.tc(e[2],n.dp),o=location.hostname.toLowerCase().split(".").reverse(),a=[o[0]];o[1]&&a.push(o[1]),a.join(".").length<=6&&o[2]&&a.push(o[2]),a=a.reverse().join("."),e[1]=""==e[1]?20:e[1],(4!=e.length||"t"!=e[3]||-1===document.cookie.indexOf(e[0]))&&(document.cookie=e[0]+"="+t+"; expires="+new Date((new Date).getTime()+24*e[1]*60*60*1e3).toUTCString()+"; domain=."+a+"; path=/")}}},e={apc:function(r){"k"in r?r.k=i.tc(r.k,c.dp):"kdp"in r&&(r.k=n[r.kdp.ds].f(r,"kdp")),"cval"in r||"dp"in r&&(r.cval=n[r.dp.ds].f(r,"dp"))},rtl:function(r){for(var n in r){for(var t=r[n],i=0;i<t.length;i++)e.apc(t[i]);return o[n].f(t)}return!1},execLogicTask:function(r,n){var t=!1;return"logic"in r&&(e.rtl(r.logic)?("try"in r&&e.taskrunner(r.try,n),t=!0):"catch"in r&&e.taskrunner(r.catch,n)),t},taskrunner:function(r,n){if(i.isArray(r))for(var t=0;t<r.length;t++)e.taskrunner(r[t],n);else if("task"in r&&"string"==typeof r.task){var o=r.task.split(":");a[o[0]](o[1],n)}}},c={asyncf:0,asyncprogress:function(){c.asyncf+=1,c.asynccomplete()},asynccomplete:function(){c.asyncf==c.resq.length&&"function"==typeof c.onComplete&&c.onComplete()},run:function(r){c.resq=[],c.asyncf=0,c.dp=(r.config||{}).dp||{},e.taskrunner(r.boot,r.config),c.asynccomplete()}},r.visualiqtag?c=r.visualiqtag:r.visualiqtag=c}(window);
var viqjson={"boot":[{"task":"logics:d2"},{"task":"logics:d5"},{"task":"logics:d30"}],"config":{"tasks":{"logics":{"d2":{"logic":{"AND":[{"E":[{"o":"!in","k":"test","dp":{"p":["host"],"ds":"RU"}}]},{"E":[{"o":"!ex","dp":{"p":["queryKey","tid"],"ds":"C"}}]}]},"try":[{"task":"url:d3"},{"task":"url:d4"}]},"d5":{"logic":{"AND":[{"E":[{"o":"in","dp":{"p":["query"],"ds":"LP"},"k":"campaignid=ps"}]},{"OR":[{"E":[{"o":"in","dp":{"p":["host"],"ds":"RU"},"k":"google"}]},{"E":[{"o":"in","dp":{"p":["host"],"ds":"RU"},"k":"bing"}]},{"E":[{"o":"in","dp":{"p":["host"],"ds":"RU"},"k":"yahoo"}]},{"E":[{"o":"in","dp":{"p":["host"],"ds":"RU"},"k":"ask"}]}]}]},"try":[{"task":"url:d6"}],"catch":[{"task":"logics:d10"}]},"d10":{"logic":{"AND":[{"E":[{"o":"!in","dp":{"p":["query"],"ds":"LP"},"k":"campaignid="}]},{"OR":[{"E":[{"o":"in","dp":{"p":["host"],"ds":"RU"},"k":"google"}]},{"E":[{"o":"in","dp":{"p":["host"],"ds":"RU"},"k":"bing"}]},{"E":[{"o":"in","dp":{"p":["host"],"ds":"RU"},"k":"yahoo"}]},{"E":[{"o":"in","dp":{"p":["host"],"ds":"RU"},"k":"ask"}]}]}]},"try":[{"task":"url:d11"}],"catch":[{"task":"logics:d22"}]},"d22":{"logic":{"AND":[{"E":[{"o":"==","dp":{"p":["host"],"ds":"RU"},"k":""}]},{"E":[{"o":"!in","dp":{"p":["query"],"ds":"LP"},"k":"campaignid"}]}]},"try":[{"task":"url:d23"}],"catch":[{"task":"url:d27"}]},"d30":{"logic":{"E":[{"o":"!==","dp":{"p":["source"],"ds":"LP"},"k":""}]},"try":[{"task":"url:d31"}]}},"url":{"d3":"https://tapestry.tapad.com/tapestry/1?ta_partner_id=950&ta_redirect=https%3A%2F%2Ft.myvisualiq.net%2Fsync%3Fprid%3D1001%26ao%3D0%26pruuid%3DTAPAD_%24%7BIDS%3Akey%7D","d4":"https://t.myvisualiq.net/sync?prid=1002&ao=0&red=https://idsync.rlcdn.com/420356.gif?partner_uid=${UUID}","d6":"https://t.myvisualiq.net/sync?prid=Test&ao=560&vndr=115&red={{d8}}","d11":"https://t.myvisualiq.net/sync?prid=1001&ao=0&red={{d12}}","d23":"https://t.myvisualiq.net/sync?prid=1001&ao=0&red={{d24}}","d27":"https://t.myvisualiq.net/sync?prid=Test&ao=560&vndr=115&red={{d28}}","d31":"https://t.myvisualiq.net/sync?prid=123&ao=0&red={{d32}}"}},"dp":{"d8":{"ds":"S","v":"https://ad.doubleclick.net/ddm/ad/N1034274.2426714VISUALIQ1/B22180880.237797886;sz=1x1;u=|VIQ_${UUID}|;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord={{d9}}","e":1,"cv":1},"d9":{"p":["r"],"ds":"JS","cv":1},"d12":{"ds":"S","v":"https://ad.doubleclick.net/ddm/ad/N1034274.2426714VISUALIQ1/B22180880.237795573;sz=1x1;u={{d17}}|{{d18}}{{d19}}|VIQ_${UUID}|{{d20}};dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord={{d21}}","e":1,"cv":1},"d17":{"p":["host"],"e":1,"ds":"RU","cv":1},"d18":{"p":["queryKey","p"],"e":1,"ds":"RU","cv":1},"d19":{"p":["queryKey","q"],"e":1,"ds":"RU","cv":1},"d20":{"p":["source"],"e":1,"ds":"LP","cv":1},"d21":{"p":["r"],"ds":"JS","cv":1},"d24":{"ds":"S","v":"https://ad.doubleclick.net/ddm/ad/N1034274.2426714VISUALIQ1/B22180880.237797595;sz=1x1;u=|VIQ_${UUID}|{{d25}};dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord={{d26}}","e":1,"cv":1},"d25":{"p":["source"],"e":1,"ds":"LP","cv":1},"d26":{"p":["r"],"ds":"JS","cv":1},"d28":{"ds":"S","v":"https://ad.doubleclick.net/ddm/ad/N1034274.2426714VISUALIQ1/B22180880.237797886;sz=1x1;u=|VIQ_${UUID}|;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord={{d29}}","e":1,"cv":1},"d29":{"p":["r"],"ds":"JS","cv":1},"d32":{"ds":"S","v":"https://www.facebook.com/tr?id=1340917529321828&ev=PageView&cd[order_id]=${UUID}","e":1,"cv":1}}}}
visualiqtag.run(viqjson);

